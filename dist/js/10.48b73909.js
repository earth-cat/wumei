"use strict";(self["webpackChunkwumei"]=self["webpackChunkwumei"]||[]).push([[10],{6010:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"IotTemplate"},[t("el-card",{staticClass:"box-card"},[t("el-form",{ref:"screen",staticClass:"fromone",attrs:{model:e.screen,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"名称"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入模型名称"},model:{value:e.screen.templateNames,callback:function(t){e.$set(e.screen,"templateNames",t)},expression:"screen.templateNames"}})],1),t("el-form-item",{attrs:{label:"类型"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择模型类别"},model:{value:e.screen.type,callback:function(t){e.$set(e.screen,"type",t)},expression:"screen.type"}},e._l(e.category,(function(e){return t("el-option",{key:e.dictSort,attrs:{label:e.dictLabel,value:e.dictSort}})})),1)],1),t("el-form-item",{staticClass:"search"},[t("el-button",{attrs:{type:"primary"},on:{click:e.initName}},[e._v("搜索")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1),t("el-form-item",{staticClass:"add"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.dialogVisible=!0}}},[e._v("新增")])],1)],1)],1),t("el-card",{staticClass:"box-card"},[t("el-table",{staticClass:"ovfo",staticStyle:{width:"100%"},attrs:{data:e.rows,fit:"",border:""}},[t("el-table-column",{attrs:{label:"名称",prop:"templateName"}}),t("el-table-column",{attrs:{label:"标识符",prop:"identifier"}}),t("el-table-column",{attrs:{label:"只读",prop:"isReadonly"}}),t("el-table-column",{attrs:{label:"首页显示",prop:"isTop"}}),t("el-table-column",{attrs:{label:"图标显示",prop:"isMonitor"}}),t("el-table-column",{attrs:{label:"系统定义",prop:"isSys"}}),t("el-table-column",{attrs:{label:"物模型类别","min-width":"92px",prop:"type"},scopedSlots:e._u([{key:"default",fn:function(a){return["属性"===a.row.type?t("el-tag",[e._v(e._s(a.row.type))]):e._e(),"功能"===a.row.type?t("el-tag",{attrs:{type:"success"}},[e._v(e._s(a.row.type))]):e._e(),"事件"===a.row.type?t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(a.row.type))]):e._e()]}}])}),t("el-table-column",{attrs:{label:"数据类型",prop:"datatype"}}),t("el-table-column",{attrs:{label:"数据定义","min-width":"150px",prop:"specs"}}),t("el-table-column",{attrs:{label:"排序",prop:"modelOrder"}}),t("el-table-column",{attrs:{label:"创建时间","min-width":"110px",prop:"createTime"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.modify(a)}}},[e._v("修改")])]}}])})],1),t("el-pagination",{attrs:{background:"","current-page":e.screen.pageNum,"page-sizes":[10,20,30,40],"page-size":e.screen.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalpage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{width:"600px",title:"添加通用物模型",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"fromInns",attrs:{model:e.popup,rules:e.lotrules}},[t("el-form-item",{attrs:{label:"模型名称",prop:"templateName","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"请输入物模型名称，例如：温度"},model:{value:e.popup.templateName,callback:function(t){e.$set(e.popup,"templateName","string"===typeof t?t.trim():t)},expression:"popup.templateName"}})],1),t("el-form-item",{attrs:{label:"模型标识",prop:"identifier","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"请输入标识符，例如：temperature"},model:{value:e.popup.identifier,callback:function(t){e.$set(e.popup,"identifier","string"===typeof t?t.trim():t)},expression:"popup.identifier"}})],1),t("el-form-item",{attrs:{label:"模型排序",prop:"modelOrder","label-width":"100px"}},[t("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.popup.modelOrder,callback:function(t){e.$set(e.popup,"modelOrder",t)},expression:"popup.modelOrder"}})],1),t("el-form-item",{attrs:{label:"模型类别",prop:"type","label-width":"100px"}},[t("el-button-group",{model:{value:e.popup.type,callback:function(t){e.$set(e.popup,"type","string"===typeof t?t.trim():t)},expression:"popup.type"}},e._l(e.category,(function(a,l){return t("el-button",{key:a.dictSort,attrs:{type:e.selectindex===l?"primary":""},on:{click:function(t){return e.categorybtn(l)}}},[e._v(e._s(a.dictLabel))])})),1)],1),t("el-form-item",{attrs:{prop:"redirectUrl","label-width":"30px"}},[t("el-switch",{attrs:{"inactive-text":"只读数据",disabled:2===e.selectindex},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}}),t("el-switch",{directives:[{name:"show",rawName:"v-show",value:2!==e.selectindex,expression:"selectindex === 2 ? false : true"}],staticStyle:{margin:"30px"},attrs:{"inactive-text":"首页显示"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}}),t("el-switch",{directives:[{name:"show",rawName:"v-show",value:0===e.selectindex,expression:"selectindex === 0 ? true : false"}],attrs:{"inactive-text":"图表显示"},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),t("el-divider"),t("el-form-item",{attrs:{label:"数据类型",prop:"datatype","label-width":"100px"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.popup.datatype,callback:function(t){e.$set(e.popup,"datatype","string"===typeof t?t.trim():t)},expression:"popup.datatype"}},e._l(e.mold,(function(e){return t("el-option",{key:e.dictSort,attrs:{label:e.dictLabel,value:e.dictValue,disabled:e.default}})})),1)],1),"integer"===e.popup.datatype||"decimal"===e.popup.datatype?[t("el-form-item",{staticClass:"numaxin",attrs:{label:"取值范围",prop:"specs","label-width":"100px"}},[t("el-input-number",{attrs:{"controls-position":"right",placeholder:"最小值"},model:{value:e.popup.specs.min,callback:function(t){e.$set(e.popup.specs,"min","string"===typeof t?t.trim():t)},expression:"popup.specs.min"}}),e._v("到 "),t("el-input-number",{attrs:{"controls-position":"right",placeholder:"最大值"},model:{value:e.popup.specs.max,callback:function(t){e.$set(e.popup.specs,"max","string"===typeof t?t.trim():t)},expression:"popup.specs.max"}})],1),t("el-form-item",{attrs:{label:"单位",prop:"specs","label-width":"72px"}},[t("el-input",{attrs:{placeholder:"请输入单位，例如：℃"},model:{value:e.popup.specs.unit,callback:function(t){e.$set(e.popup.specs,"unit","string"===typeof t?t.trim():t)},expression:"popup.specs.unit"}})],1),t("el-form-item",{attrs:{label:"步长",prop:"specs","label-width":"72px"}},[t("el-input",{attrs:{placeholder:"请输入步长，例如：1"},model:{value:e.popup.specs.step,callback:function(t){e.$set(e.popup.specs,"step","string"===typeof t?t.trim():t)},expression:"popup.specs.step"}})],1)]:"bool"===e.popup.datatype?[t("el-form-item",{attrs:{label:"布尔值",prop:"specs","label-width":"100px"}},[t("el-input",{staticStyle:{width:"auto","margin-bottom":"10px"},attrs:{"controls-position":"right",placeholder:"例如：关闭"},model:{value:e.popup.specs.falseText,callback:function(t){e.$set(e.popup.specs,"falseText","string"===typeof t?t.trim():t)},expression:"popup.specs.falseText"}}),e._v(" （0 值对应文本） "),t("el-input",{staticStyle:{width:"auto"},attrs:{"controls-position":"right",placeholder:"例如：打开"},model:{value:e.popup.specs.trueText,callback:function(t){e.$set(e.popup.specs,"trueText","string"===typeof t?t.trim():t)},expression:"popup.specs.trueText"}}),e._v(" （1 值对应文本） ")],1)]:"enum"===e.popup.datatype?[t("el-form-item",{attrs:{label:"枚举项",prop:"specs","label-width":"100px"}},[e._l(e.popup.specs.enumList,(function(a,l){return t("el-row",{key:a.key,staticStyle:{"margin-bottom":"10px"}},[t("el-input",{staticStyle:{width:"auto","margin-right":"10px"},attrs:{"controls-position":"right",placeholder:"参数值，例如：0"},model:{value:a.value,callback:function(t){e.$set(a,"value","string"===typeof t?t.trim():t)},expression:"domain.value"}}),t("el-input",{staticStyle:{width:"auto","margin-right":"10px"},attrs:{"controls-position":"right",placeholder:"参数描述，例如：中速档位"},model:{value:a.text,callback:function(t){e.$set(a,"text","string"===typeof t?t.trim():t)},expression:"domain.text"}}),0!==l?t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return t.preventDefault(),e.removeDomain(a)}}},[e._v("删除")]):e._e()],1)})),t("el-button",{attrs:{type:"text"},on:{click:e.addDomain}},[e._v("+添加枚举项")])],2)]:"string"===e.popup.datatype?[t("el-form-item",{attrs:{label:"最大长度",prop:"specs","label-width":"100px"}},[t("el-input",{staticStyle:{width:"auto"},attrs:{"controls-position":"right",placeholder:"例如：1024"},model:{value:e.popup.specs.maxLength,callback:function(t){e.$set(e.popup.specs,"maxLength","string"===typeof t?t.trim():t)},expression:"popup.specs.maxLength"}}),e._v(" （字符串的最大长度） ")],1)]:"array"===e.popup.datatype?[t("el-form-item",{attrs:{label:"数组类型",prop:"specs","label-width":"100px"}},[t("el-radio-group",{model:{value:e.popup.specs.arrayType,callback:function(t){e.$set(e.popup.specs,"arrayType",t)},expression:"popup.specs.arrayType"}},[t("el-radio",{attrs:{label:"int"}},[e._v("int（整数）")]),t("el-radio",{attrs:{label:"double"}},[e._v("double（小数）")]),t("el-radio",{attrs:{label:"string"}},[e._v("string（字符串）")])],1)],1)]:e._e(),[t("el-button",{attrs:{type:"primary"},on:{click:e.addTemplate}},[e._v("确定")]),t("el-button",{on:{click:e.handleClose}},[e._v("取消")])]],2)],1)],1)},p=[],s=(a(7658),a(6280)),i={name:"IotTemplate",data(){return{screen:{templateNames:"",type:"",pageNum:1,pageSize:10},popup:{createBy:"wumei",createTime:null,datatype:"integer",delFlag:null,identifier:"",isMonitor:null,isReadonly:null,isSys:null,isTop:null,modelOrder:"",remark:null,specs:{type:"",falseText:"",trueText:"",max:"",min:"",unit:"",step:"",maxLength:"",arrayType:"",enumList:[{text:"",value:""}]},templateId:null,templateName:"",tenantId:null,tenantName:null,type:"",updateBy:null,updateTime:null,userId:null,userName:null},lotrules:{templateName:[{required:!0,message:"物模型名称不能为空",trigger:"blur"}],identifier:[{required:!0,message:"标识符，产品下唯一不能为空",trigger:"blur"}]},dialogVisible:!1,rows:[],category:[],mold:[],value1:!0,value2:!0,value3:!0,dictSort:"",selectindex:0,totalpage:null}},methods:{async init(){try{let{pageNum:e,pageSize:t}=this.screen,{code:a,rows:l,total:p}=await this.$api.currency.queryList(e,t);200===+a&&(this.rows=l,this.totalpage=p,this.format(this.rows))}catch(e){}},async iotThing(){try{let{code:e,data:t}=await this.$api.currency.iotThing();200===+e&&(this.category=t)}catch(e){}},async iotData(){try{let{code:e,data:t}=await this.$api.currency.iotData();200===+e&&(this.mold=t,this.mold.forEach((e=>{e.default=!1})),this.DisableChartt())}catch(e){}},async addTemplate(){try{let e=this.$api.currency.addTemplate;this.popup.templateId?e=this.$api.currency.updataTemplate:(this.popup.specs.type=this.popup.datatype,this.popup.type=this.popup.type+1),this.popup.specs=JSON.stringify(this.popup.specs);let{code:t}=await e(this.popup);200===t&&(this.handleClose(),this.$message.success("操作成功"),this.init())}catch(e){}},async initName(){try{let{pageNum:e,pageSize:t,templateNames:a,type:l}=this.screen;if(l){let{code:p,rows:s,total:i}=await this.$api.currency.queryList3(e,t,a,l);200===+p&&(this.rows=s,this.totalpage=i,this.format(this.rows))}else{let{code:a,rows:l,total:p}=await this.$api.currency.queryList2(e,t,templateName);200===+a&&(this.rows=l,this.totalpage=p,this.format(this.rows))}}catch(e){}},async modify(e){try{this.dialogVisible=!0;let{code:t,data:a}=await this.$api.currency.updata(e.templateId);200===t&&(this.popup=a,this.popup.specs=JSON.parse(this.popup.specs))}catch(t){}},format(e){e.forEach((e=>{1===+e.isReadonly?e.isReadonly="是":e.isReadonly="否",1===+e.isTop?e.isTop="是":e.isTop="否",1===+e.isMonitor?e.isMonitor="是":e.isMonitor="否",1===+e.isSys?e.isSys="是":e.isSys="否",1===+e.type?e.type="属性":2===+e.type?e.type="功能":e.type="事件","bool"===e.datatype?e.datatype="布尔":"integer"===e.datatype?e.datatype="整数":"decimal"===e.datatype?e.datatype="小数":"enum"===e.datatype?e.datatype="枚举":"string"===e.datatype?e.datatype="字符串":"array"===e.datatype&&(e.datatype="数组");let t=JSON.parse(e.specs);"bool"===t.type?e.specs=`0:${t.falseText} 1:${t.trueText}`:"integer"===t.type||"decimal"===t.type?e.specs=`最大值:${t.max} 最小值:${t.min} 步长:${t.step} 单位:${t.unit}`:"enum"===t.type?e.specs=t.enumList.map((e=>`${e.value}:${e.text}`)):"string"===t.type?e.specs=`最大长度:${t.maxLength}`:"array"===t.type?e.specs=`数组类型:${t.arrayType}`:e.specs="",e.createTime=(0,s.formatTime)(e.createTime,"{0}-{1}-{2}")}))},categorybtn(e){this.popup.type=e,this.selectindex!==e&&(this.selectindex=e,0!==this.selectindex?(this.value3=!1,this.DisableChartt()):(this.value3=!0,this.DisableChartt()),2===this.selectindex?(this.value1=!0,this.value2=!1,this.DisableChartt()):(this.value2=!0,this.DisableChartt()))},reset(){this.screen.templateNames="",this.screen.type="",this.init()},DisableChartt(){if(this.value1?this.popup.isReadonly=1:this.popup.isReadonly=0,this.value2?this.popup.isTop=1:this.popup.isTop=0,this.value3){this.popup.isMonitor=1;for(let e=2;e<this.mold.length;e++)this.mold[e].default=!0}else{this.popup.isMonitor=0;for(let e=2;e<this.mold.length;e++)this.mold[e].default=!1}},handleSizeChange(e){this.pageSize=e,this.init()},handleCurrentChange(e){this.screen.pageNum=e,this.init()},handleClose(){this.$refs.fromInns.resetFields(),this.popup={createBy:"wumei",createTime:null,datatype:"integer",delFlag:null,identifier:"",isMonitor:null,isReadonly:null,isSys:null,isTop:null,modelOrder:"",remark:null,specs:{type:"",falseText:"",trueText:"",max:"",min:"",unit:"",step:"",maxLength:"",arrayType:"",enumList:[{text:"",value:""}]},templateId:null,templateName:"",tenantId:null,tenantName:null,type:"",updateBy:null,updateTime:null,userId:null,userName:null},this.dialogVisible=!1},removeDomain(e){let t=this.popup.specs.enumList.indexOf(e);-1!==t&&this.popup.specs.enumList.splice(t,1)},addDomain(){this.popup.specs.enumList.push({text:"",value:"",key:Date.now()})}},created(){this.init(),this.iotData(),this.iotThing()},updated(){this.DisableChartt()}},r=i,o=a(1001),n=(0,o.Z)(r,l,p,!1,null,"df7300c2",null),u=n.exports}}]);