"use strict";(self["webpackChunkwumei"]=self["webpackChunkwumei"]||[]).push([[577],{7577:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"IotProduct"},[e("el-card",{staticClass:"box-card",attrs:{"body-style":{marginBottom:"5px"}}},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,modal:t.rulfrom}},[e("el-form-item",{attrs:{label:"产品名称",prop:"productsname"}},[e("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.rulfrom.productsname,callback:function(e){t.$set(t.rulfrom,"productsname",e)},expression:"rulfrom.productsname"}})],1),e("el-form-item",{attrs:{label:"分类名称",prop:"className"}},[e("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:t.rulfrom.className,callback:function(e){t.$set(t.rulfrom,"className",e)},expression:"rulfrom.className"}})],1),e("el-form-item",{attrs:{label:"状态",prop:"region"}},[e("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.rulfrom.region,callback:function(e){t.$set(t.rulfrom,"region",e)},expression:"rulfrom.region"}},t._l(t.stateType,(function(t,s){return e("el-option",{key:s,attrs:{label:t.dictLabel,value:t.dictLabel}})})),1)],1),e("el-button",{attrs:{type:"primary"}},[t._v("搜索")]),e("el-button",[t._v("重置")]),e("el-button",{staticClass:"elBut",attrs:{type:"primary",plain:""},on:{click:t.subAdd}},[e("i",{staticClass:"el-icon-plus"}),t._v(" 新增 ")])],1)],1),e("div",{staticClass:"card-bottom"},[t._l(t.proList,(function(s,a){return e("div",{key:a,staticClass:"card-item"},[e("el-card",{attrs:{"body-style":{padding:"20px"}}},[e("div",{staticClass:"top"},[e("div",{staticClass:"top-left"},[e("i",{staticClass:"el-icon-menu"}),t._v(" "+t._s(s.productName)+" "),e("el-tag",{directives:[{name:"show",rawName:"v-show",value:s.isSys,expression:"item.isSys"}],attrs:{type:"info"}},[t._v("系统")])],1),[e("el-tooltip",{attrs:{content:"取消发布",placement:"top"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:1===s.status,expression:"item.status === 1"}],attrs:{type:t.stateType[s.status-1].listClass,size:"mini"},on:{click:function(e){return t.open1(s.productId,s.status)}}},[t._v("未发布")])],1),e("el-tooltip",{attrs:{content:"取消发布",placement:"top"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:2===s.status,expression:"item.status === 2"}],attrs:{type:t.stateType[s.status-1].listClass,size:"mini"},on:{click:function(e){return t.open(s.productId,s.status)}}},[t._v("已发布")])],1)]],2),e("div",{staticClass:"bot-left"},[e("el-descriptions",{attrs:{column:1}},[e("el-descriptions-item",{attrs:{label:"所属分类"}},[e("el-link",{attrs:{type:"primary"}},[t._v(t._s(s.categoryName))])],1),e("el-descriptions-item",{attrs:{label:"产品类型"}},[t._v(t._s(1===s.deviceType?"直连设备":"网关设备"))]),e("el-descriptions-item",{attrs:{label:"联网方式"}},[t._v(t._s(t.networking[s.networkMethod-1].dictLabel))]),e("el-descriptions-item",{attrs:{label:"设备授权"}},[e("el-tag",{attrs:{type:0===s.isAuthorize?"info":"success",size:"small"}},[t._v(t._s(0===s.isAuthorize?"未启用":"已启用"))])],1)],1),e("el-image",{attrs:{src:""+(null===s.imgUrl?"https://iot.wumei.live/static/img/product.8957f07e.jpg":`https://iot.wumei.live/prod-api${s.imgUrl}`),"preview-src-list":[""+(null===s.imgUrl?"https://iot.wumei.live/static/img/product.8957f07e.jpg":`https://iot.wumei.live/prod-api${s.imgUrl}`)]}})],1),e("div",{staticClass:"bot-bottom"},[e("el-button",{attrs:{type:"primary",size:"small"}},[e("i",{staticClass:"el-icon-edit"}),t._v("详情")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:1!==s.status,expression:"item.status === 1 ? false : true"}],attrs:{type:"success",size:"small",disabled:0===s.isAuthorize}},[e("i",{staticClass:"el-icon-coordinate"}),t._v("设备授权")]),[e("el-button",{directives:[{name:"show",rawName:"v-show",value:s.isShow,expression:"item.isShow"}],attrs:{type:"danger",size:"small"},on:{click:function(e){return t.open3(s.productId)}}},[e("i",{staticClass:"el-icon-coordinate"}),t._v("删除 ")])],e("el-button",{attrs:{type:"warning",size:"small"}},[e("i",{staticClass:"el-icon-search"}),t._v("查看设备")])],2)])],1)})),e("el-pagination",{attrs:{background:"","current-page":t.pageNum,"page-sizes":[12,24,36,60],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalpage},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],2)],1)},i=[],r=(s(7658),{name:"IotProduct",data(){return{stateType:[],proList:[],pageNum:1,networking:[],isShow:!1,productType:[],pageSize:12,totalpage:null,rulfrom:{productsname:"",className:"",region:""}}},methods:{async open(t,e){let{data:s}=await this.$api.products.statusData(t);this.$confirm(`重要提示：产品下已有${s}个设备，取消发布可以修改产品信息和模型，重新发布后对应设备状态将会被重置！`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.btn(t,e),this.$confirm("操作成功","系统提示",{confirmButtonText:"确定",type:"success"})}))},async open1(t,e){this.$confirm("产品发布后，可以创建对应的设备","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.btn(t,e),this.$confirm("操作成功","系统提示",{confirmButtonText:"确定",type:"success"})}))},async open3(t){this.$confirm(`是否确认删除产品编号为"${t}"的数据项？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delect(t)}))},async init(){try{let{code:t,data:e}=await this.$api.products.states();200===+t&&(this.stateType=e)}catch(t){}},async productsList(t){try{let{code:e,rows:s,total:a}=await this.$api.products.productsList(this.pageNum,this.pageSize);200===e&&(this.totalpage=a,this.proList=s,this.proList.forEach((e=>{e.productId===t&&1===e.status?e.isShow=!e.isShow:e.isShow=!1})))}catch(e){}},async network(){try{let{code:t,data:e}=await this.$api.products.networking();200===+t&&(this.networking=e)}catch(t){}},async productTy(){let{code:t,data:e}=await this.$api.products.productType();200===+t&&(this.productType=e)},handleSizeChange(t){this.pageSize=t,this.productsList()},handleCurrentChange(t){this.pageNum=t,this.productsList()},async btn(t,e){e=1===e?2:1;let{code:s}=await this.$api.products.statusModify(t,e);200===s&&this.productsList(t,e)},async delect(t){try{let{code:e,msg:s}=await this.$api.products.delectProduct(t);if(200===+e)return void this.$message.success("删除成功");this.$notify.error({title:s})}catch(e){}},subAdd(){this.$router.push({path:"productEdit",name:"productEdit",query:{productId:0,pageNum:this.pageNum}})}},created(){this.init(),this.network(),this.productsList()}}),o=r,l=s(1001),n=(0,l.Z)(o,a,i,!1,null,"06de5b17",null),c=n.exports}}]);